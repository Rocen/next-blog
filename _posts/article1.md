---
title: Next.js入门（为什么选择Next.js）
description: Next.js是一个灵活的React框架，为您提供了创建快速web应用程序的构建块。
date: 12 April 2023
categories: Next
---

## 目录
- [前言](#前言)
- [Next.js的优势](#Next.js的优势)
- [完善的工程化机制](#完善的工程化机制)
- [良好的开发和构建性能](#良好的开发和构建性能)
- [智能文件路由系统](#智能文件路由系统)
- [多种渲染模式](#多种渲染模式)
- [可扩展配置](#可扩展配置)
- [性能优化](#性能优化)
- [其他常用功能或者扩展](#其他常用功能或者扩展)
- [对比React单页应用](#对比React单页应用)
- [最后](#最后)


## 前言
虽然`Next.js`已经推出了很多年，当时只是粗略的了解和体验了一下，并没有进行深入的学习和实践。 

那么，现在决定学习`Next.js`的原因是什么？

### 原因
主要的原因是：根据`React`官方最新文档的指导，已经将`Next.js`作为**开始一个新的React项目**的推荐选择。

也就是说目前`React`官方已经明确的将`Next.js`作为项目开发的首要选择，其重要性可想而知。

## Next.js的优势
`Next.js`是一个`React web`应用框架，也就是基于`React`的上层框架，然后它主要做的事情有以下几点：
1. 完善的工程化机制
2. 良好的开发和构建性能
3. 智能文件路由系统
4. 多种渲染模式
5. 可扩展配置
6. 性能优化方案
7. 其他常用功能或者扩展

## 完善的工程化机制
开发者不必要手动配置`webpack`，因为它已经内置了部分基础的工程化：
+ 内置`babel`，支持JS代码向后兼容
+ 内置`postcss`，支持CSS代码向后兼容
+ `browserslist`支持配置兼容的浏览器信息，配合`babel`和`postcss`工作
+ `TypeScript`可选择使用，保证代码的质量，以及可阅读性和可维护性
+ `eslint`可选择使用，检测代码格式，可自定义规则
+ `prettier`可通过扩展使用，格式化代码，可自定义规则
+ 内置`css modules` 
+ 可扩展使用`css-in-js`
+ 可扩展使用`tailwind css`

除此之外，还有优化的打包功能：
+ `tree shaking`
+ 代码压缩
+ 页面自动静态化
+ 按需打包第三方`es`包
+ 异步动态加载组件

综上所述，基本上使用了`Next.js`就不必要去处理工程化相关的事项。同时也可以通过比较简单的方式去优化打包时的性能，在每次构建完成之后都会默认输出页面资源大小的信息，方便及时查看。

## 良好的开发和构建性能
在`Next13`中加入了全新的打包工具`Turbopack`，它是出自`Webpack`作者`TobiasKoppers`之手，官方描述是：开发时更新速度比`Webpack`快**700**倍、比`Vite`快**10**倍。

## 智能文件路由系统
`Next.js`的智能文件路由指的是，页面写在`pages`目录下的`js`文件都会被认为是页面，最终根据文件路径会自动生成页面对应的路由。

## 多种渲染模式
目前Next.js包含的页面渲染模式包括：
+ `CSR`
+ `SSR`
+ `SSG`
+ `ISG`

这些渲染模式是`Next.js`最核心的概念，建议一定要了解透彻。

## 可扩展配置
`Next.js`默认准备了一套就很好用的基础配置，但这些配置基本上用户都可以**完全**控制它。
根据官方文档的描述：
+ `next.config.js`暴露了`webpack`的实例，可以扩展`webpack`相关的配置
+ `next.config.js`支持自定义配置
+ 自定义`server`，启动一个`nodejs`作为服务端
+ 自定哦`App`，即`_app.js`文件，用于处理多个页面的公共部分
+ 自定义`Document`，即`_document.js`文件，用于作为`html`模版
+ 自定义错误页面，如*404*或者*500*等错误状态的页面
+ 还可以自定义`babel`和`postcss`等工程化规则配置

由此可见，`next.js`在基础配置外还保留了高度的可扩展性。

## 性能优化
`Next.js`对于静态资源默认做了一些优化：
+ 图片优化：`Next.js`内置了`next/image`组件，对于使用的图片会使用浏览器原生的惰性加载进行优化
+ 字体优化：`Next.js`内置`了next/font`组件，对于引入的字体会进行优化

## 其他常用功能或者扩展
`Next.js`包含的其他功能：
+ `API Routes`：`Next.js`支持在`pages/api`目录下编写接口，在前端页面中发起的`Ajax`请求默认都会走到`api`目录下对应的`api`路由进行处理，如果没找到对应的`api`路由，则会报*404*
+ `neext/amp`: 即移动端页面
+ `@next/mdx`: `next.js`支持使用`mdx`编写页面

## 对比React单页应用
过去`React`官方提供了`create-react-app`脚手架（简称CRA），用于创建一个新的`react`项目，这种项目一般被称为单页应用（SPA）。  
但是`CRA`对于开发者并不好用，使用时需要到社区额外的找一些完整的模版，或者新增各种配置和规范（`react-router-dom`、`webpack`、`babel`、预处理`css`等）。简单来说，就是需要开发者配置的基础内容太多，并不能做到**开箱即用**，这也是过去被诟病已久的主要问题。
再加上`React18`中新增的`Server Component`和**并发特性**等，`CRA`都无法完全发挥出`React`的能力，所以`CRA`已经逐渐被`Next.js`或者`Gatsby.js`所取代。
当然，这只是从*脚手架*这一层面角度来讨论`CRA`和N`ext.js`两者之间的区别。

## 最后
虽然，`Next.js`有上述很多的优点，但同样也存在着一些缺点或者说不友好的地方：
+ 上手难度高：`Next.js`是一个全栈框架（即包括前端也包括后端，后端主要指的是`Node.js`）。所以想要使用`Next.js`就必须了解`Node.js`和服务端的相关知识
+ 心智负担大：需要熟悉`SSR`、`SSG`、`CSR`和`ISR`多种渲染模式，以及对应数据获取的方式，这决定了开发者应该如何编写页面
+ 嵌套路由：因为页面路由是根据文件路径自动生成的，在嵌套层级比较深的情况下会很难维护（`Next 13`通过更改目录解决了这一问题）

除此之外，还有一些需要开发者去处理的事情，比如请求方法和状态管理等。

